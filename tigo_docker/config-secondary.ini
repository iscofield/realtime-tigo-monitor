# TapTap-MQTT Configuration - Secondary CCA
# Credentials are injected via environment variables at startup

[MQTT]
SERVER = ${MQTT_SERVER}
PORT = ${MQTT_PORT}
USER = ${MQTT_USER}
PASS = ${MQTT_PASS}
QOS = 1
TIMEOUT = 30

[TAPTAP]
LOG_LEVEL = info
BINARY = /usr/local/bin/taptap
SERIAL = /dev/ttyACM3
# WORKAROUND: ADDRESS must be present (even empty) due to taptap-mqtt.py validation bug
ADDRESS =
PORT = 502
# 27 panels across strings F-H (all modules must be on single comma-separated line)
MODULES = F:01:4-C3F48AP,F:02:4-C472F6Y,F:03:4-C3F096W,F:04:4-C3F46FV,F:05:4-C47476L,F:06:4-C3EF8ET,F:07:4-C47479N,F:08:4-C3EF8BM,F:09:4-C3F25AZ,F:10:4-C3F268N,F:11:4-C47475H,G:01:4-C3F34CZ,G:02:4-C3F28DT,G:03:4-C3F1F8Z,G:04:4-C3F2B0H,G:05:4-C3F27AM,G:06:4-C3F1E0H,G:07:4-C3F26CT,G:08:4-C3F29ET,G:09:4-C3F293Y,G:10:4-C3EE48N,G:11:4-C3F285H,H:01:4-C3D641S,H:02:4-C3F1DFW,H:03:4-C3F284J,H:04:4-C3F20FJ,H:05:4-C3F214S
TOPIC_PREFIX = taptap
TOPIC_NAME = secondary
TIMEOUT = 300
UPDATE = 60
STATE_FILE = /data/taptap.state

[HA]
DISCOVERY_PREFIX = homeassistant
DISCOVERY_LEGACY = false
BIRTH_TOPIC = homeassistant/status
NODES_AVAILABILITY_ONLINE = true
NODES_AVAILABILITY_IDENTIFIED = true
STRINGS_AVAILABILITY_ONLINE = true
STRINGS_AVAILABILITY_IDENTIFIED = true
STATS_AVAILABILITY_ONLINE = true
STATS_AVAILABILITY_IDENTIFIED = true
NODES_SENSORS_RECORDER = energy
STRINGS_SENSORS_RECORDER = energy_daily
STATS_SENSORS_RECORDER = energy_daily

[RUNTIME]
MAX_ERROR = 15
RUN_FILE = /run/taptap/taptap.run
